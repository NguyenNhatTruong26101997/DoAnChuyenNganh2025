<!doctype html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Thanh toán - Laptop World</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <h3>Thanh toán</h3>
      <div id="cart-root"></div>

      <hr>
      <form id="checkout-form">
        <div class="mb-3">
          <label class="form-label">Họ tên (tùy chọn)</label>
          <input id="name" class="form-control">
        </div>
        <div class="mb-3">
          <label class="form-label">Địa chỉ giao hàng</label>
          <textarea id="address" class="form-control"></textarea>
        </div>
        <button class="btn btn-primary">Xác nhận đặt hàng</button>
      </form>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // render cart
        if (window.renderCart) renderCart('#cart-root');
        document.getElementById('checkout-form').addEventListener('submit', async (e) => {
          e.preventDefault();
          const address = document.getElementById('address').value;
          // submit order using global submitOrder
          const res = await submitOrder(null, address);
          if (res && res.orderId) {
            location.href = '/pages/invoice.html?orderId=' + encodeURIComponent(res.orderId);
          } else {
            alert(res.error || 'Đặt hàng thất bại');
          }
        });
      });
    </script>
    <script src="/js/main.js"></script>
  </body>
</html>
